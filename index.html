<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>教科書コーチ v4.3.1（第5課）</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>教科書コーチ v4.3.1（第5課）</h1>
    <nav>
      <button class="tab-btn active" data-tab="home" type="button">ホーム</button>
      <button class="tab-btn" data-tab="shadow" type="button">シャドーウィング</button>
      <button class="tab-btn" data-tab="vocab" type="button">語彙</button>
      <button class="tab-btn" data-tab="grammar" type="button">文型ドリル</button>
      <button class="tab-btn" data-tab="pron" type="button">発音</button>
      <button class="tab-btn" data-tab="progress" type="button">学習履歴</button>
    </nav>
    <div id="status" class="note"></div>
  </header>

  <main>
    <section id="home" class="tab active">
      <h2>ホーム</h2>
      <ul>
        <li>ひとつのURLで<b>シャドーウィング・語彙・文型・発音・履歴</b>が利用できます。</li>
        <li>音声：<code>audio/lesson5_text.mp3</code> と <code>audio/lesson_vocab_master.mp3</code> を置くと快適。</li>
        <li>ブラウザ互換：Chrome/Edge推奨。iOSは音声認識非対応のため<b>録音のみモード</b>も用意。</li>
      </ul>
    </section>

    <section id="shadow" class="tab">
      <h2>シャドーウィング</h2>
      <div class="card">
        <div class="row">
          <button id="shadow-play" type="button">▶ 再生</button>
          <button id="shadow-pause" type="button">⏸ 一時停止</button>
          <label>速度: <input id="shadow-rate" type="range" min="0.7" max="1.3" step="0.05" value="1.00"></label>
          <span id="shadow-ratev">1.00x</span>
          <label><input id="shadow-loop" type="checkbox" checked> ループ</label>
          <button id="shadow-pick" type="button">音声を選ぶ</button>
        </div>
        <audio id="shadow-aud" src="audio/lesson5_text.mp3" preload="auto" controls style="width:100%"></audio>
        <div class="note">現在の音源: <code id="shadow-src">audio/lesson5_text.mp3</code></div>
        <div class="shadow-text" id="shadow-text"></div>
      </div>
    </section>

    <section id="vocab" class="tab">
      <h2>語彙</h2>
      <div class="card">
        <div class="note">単語をクリックすると音声が再生されます（優先：個別MP3 → まとめ音声の区間）。</div>
        <div id="vocab-list"></div>
      </div>
      <div class="card">
        <h3>語彙クイズ（落ちゲー）</h3>
        <div class="row"><span>お題：</span><b id="fall-prompt" style="font-size:18px"></b></div>
        <label><input type="checkbox" id="easy"> やさしいモード</label>
        <div id="fall-area"></div>
        <div class="hud"><span>問題 <b id="round">0</b>/5</span><span>スコア <b id="score">0</b></span><span>残り <b id="time">0</b>s</span></div>
        <button id="fall-start" type="button">開始</button>
      </div>
    </section>

    <section id="grammar" class="tab">
      <h2>文型ドリル</h2>
      <div id="gram-free"></div>
      <div class="card">
        <h3>コピュラ（이에요/예요）トレーナー</h3>
        <div id="copula"></div>
      </div>
      <div class="card">
        <h3>빈칸 채우기（이에요/예요 選択）</h3>
        <div id="copula-quiz"></div>
      </div>
    </section>

    <section id="pron" class="tab">
      <h2>発音フィードバック</h2>
      <div class="card">
        <label><input type="radio" name="prmode" value="sr" checked> 評価モード（Web Speech対応端末）</label>
        <label><input type="radio" name="prmode" value="rec"> 録音のみ（全端末）</label>
      </div>
      <ol id="pron-list"></ol>
      <div class="row">
        <select id="pron-select"></select>
        <button id="pron-start" type="button">🎙️開始</button>
        <button id="pron-stop" type="button" disabled>■ 停止</button>
      </div>
      <audio id="rec-play" controls style="display:none;width:100%"></audio>
      <div id="pron-out" class="note"></div>
      <div id="device-note" class="note"></div>
    </section>

    <section id="progress" class="tab">
      <h2>学習履歴</h2>
      <div id="prog"></div>
      <button id="prog-reset" type="button">リセット</button>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
